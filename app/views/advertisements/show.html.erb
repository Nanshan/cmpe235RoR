<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
</head>

<body>
<script>
$(function () { 
    $('#container').highcharts({
        chart: {
            type: 'pie'
        },
        title: {
            text: 'Events by Type for <%=@advert.name%>'
        },
        series: [{
	    name: ['Events Tracked']
	    data: [{
		name: 'Impression',
		y: <%=@advert.events.where(type: "ImpressionEvent").length%>
	     }, {
		name: 'Click',
		y: <%=@advert.events.where(type: "ClickEvent").length%>
	     }, {
		name: 'Click-through',
		y: <%=@advert.events.where(type: "ClickThroughEvent").length%>
	     }, {
		name: 'SMS',
		y: <%=@advert.events.where(type: "SMSEvent").length%>
	     }, {
		name: 'Map',
		y: <%=@advert.events.where(type: "MapEvent").length%>
	     }, {
		name: 'Call',
		y: <%=@advert.events.where(type: "CallEvent").length%>
	     }]
        }]
    });
});
</script>
<div id="container" style="width:100%; height:400px;"></div>
</body>
